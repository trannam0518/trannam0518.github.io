<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Appland Bootstrap Template - Index</title>
  <meta content="" name="descriptison">
  <meta content="" name="keywords">
	
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.4.2/tabletop.min.js"></script>
	  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script> -->

<!-- datatable -->
	<link rel="stylesheet" href="MyDataTables/Bootstrap/css/bootstrap.min.css" >
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css" >
	<link href="MyDataTables/DataTables/css/dataTables.bootstrap4.min.css">
	<link href="MyDataTables/Buttons/css/dataTables.bootstrap4.min.css">
	<link href="MyDataTables/Select/css/select.bootstrap4.min.css">
	<link href="MyDataTables/Editor/css/editor.bootstrap4.min.css">


  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.4.2/tabletop.min.js"></script>


<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/icofont/icofont.min.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/venobox/venobox.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: Appland - v2.0.0
  * Template URL: https://bootstrapmade.com/free-bootstrap-app-landing-page-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
  

  
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top">
    <div class="container d-flex">

      <div class="logo mr-auto">
        <h1 class="text-light"><a href="index.html">Appland</a></h1>
        <!-- Uncomment below if you prefer to use an image logo -->
        <!-- <a href="index.html"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->
      </div>

      <nav class="nav-menu d-none d-lg-block">
        <ul>
          <li class="active"><a href="#header">Home</a></li>
          <li><a href="#features">App Features</a></li>
          <li><a href="#gallery">Gallery</a></li>
          <li><a href="#pricing">Pricing</a></li>
          <li><a href="#faq">F.A.Q</a></li>
          <li><a href="#contact">Contact Us</a></li>

          <li class="get-started"><a href="#features">Get Started</a></li>
        </ul>
      </nav><!-- .nav-menu -->

    </div>
  </header><!-- End Header -->

  <!-- ======= Hero Section ======= -->
  <section id="hero" class="d-flex align-items-center">

    <div class="container">
      <div class="row">
        <div class="col-lg-6 d-lg-flex flex-lg-column justify-content-center align-items-stretch pt-5 pt-lg-0 order-2 order-lg-1" data-aos="fade-up">
          <div>
            <h1>App landing page template</h1>
            <h2>Lorem ipsum dolor sit amet, tota senserit percipitur ius ut, usu et fastidii forensibus voluptatibus. His ei nihil feugait</h2>
            <a href="#" class="download-btn"><i class="bx bxl-play-store"></i> Google Play</a>
            <a href="#" class="download-btn"><i class="bx bxl-apple"></i> App Store</a>
          </div>
        </div>
        <div class="col-lg-6 d-lg-flex flex-lg-column align-items-stretch order-1 order-lg-2 hero-img" data-aos="fade-up">
          <img src="assets/img/hero-img.png" class="img-fluid" alt="">
        </div>
      </div>
    </div>

  </section><!-- End Hero -->

  <main id="main">

    <!-- ======= App Features Section ======= -->
    <section id="features" class="features">
      <div class="container">

        <div class="section-title">
          <h2>App Features</h2>
          <p>Magnam dolores commodi suscipit. Necessitatibus eius consequatur ex aliquid fuga eum quidem. Sit sint consectetur velit. Quisquam quos quisquam cupiditate. Et nemo qui impedit suscipit alias ea. Quia fugiat sit in iste officiis commodi quidem hic quas.</p>
        </div>

        <table id="example" class="table table-striped table-bordered" width="100%"></table>

      </div>
    </section><!-- End App Features Section -->



    <!-- ======= Gallery Section ======= -->
    <section id="gallery" class="gallery">
      <div class="container">

        <div class="section-title">
          <h2>Gallery</h2>
          <p>Magnam dolores commodi suscipit. Necessitatibus eius consequatur ex aliquid fuga eum quidem. Sit sint consectetur velit. Quisquam quos quisquam cupiditate. Et nemo qui impedit suscipit alias ea. Quia fugiat sit in iste officiis commodi quidem hic quas.</p>
        </div>
		
		<table id="example1" class="display table-bordered" width="100%"></table>
        
      </div>
    </section><!-- End Gallery Section -->

    <!-- ======= Testimonials Section ======= -->
    <section id="testimonials" class="testimonials section-bg">
      <div class="container">

        <div class="section-title">
          <h2>Testimonials</h2>
          <p>Magnam dolores commodi suscipit. Necessitatibus eius consequatur ex aliquid fuga eum quidem. Sit sint consectetur velit. Quisquam quos quisquam cupiditate. Et nemo qui impedit suscipit alias ea. Quia fugiat sit in iste officiis commodi quidem hic quas.</p>
        </div>

        

      </div>
    </section><!-- End Testimonials Section -->

    <!-- ======= Pricing Section ======= -->
    <section id="pricing" class="pricing">
      <div class="container">

        <div class="section-title">
          <h2>Pricing</h2>
          <p>Magnam dolores commodi suscipit. Necessitatibus eius consequatur ex aliquid fuga eum quidem. Sit sint consectetur velit. Quisquam quos quisquam cupiditate. Et nemo qui impedit suscipit alias ea. Quia fugiat sit in iste officiis commodi quidem hic quas.</p>
        </div>

      

      </div>
    </section><!-- End Pricing Section -->

    <!-- ======= Frequently Asked Questions Section ======= -->
    <section id="faq" class="faq section-bg">
      <div class="container">

        <div class="section-title">

          <h2>Frequently Asked Questions</h2>
          <p>Magnam dolores commodi suscipit. Necessitatibus eius consequatur ex aliquid fuga eum quidem. Sit sint consectetur velit. Quisquam quos quisquam cupiditate. Et nemo qui impedit suscipit alias ea. Quia fugiat sit in iste officiis commodi quidem hic quas.</p>
        </div>
	
        

      </div>
    </section><!-- End Frequently Asked Questions Section -->

    <!-- ======= Contact Section ======= -->
    <section id="contact" class="contact">
      <div class="container">

        <div class="section-title">
          <h2>Contact</h2>
          <p>Magnam dolores commodi suscipit. Necessitatibus eius consequatur ex aliquid fuga eum quidem. Sit sint consectetur velit. Quisquam quos quisquam cupiditate. Et nemo qui impedit suscipit alias ea. Quia fugiat sit in iste officiis commodi quidem hic quas.</p>
        </div>

			<form>
		<div class="form-group">
		<label for="province_from">Tinh/TP</label>
			<select class="form-control select2" name="province_from" id="province_from" tabindex="-1" aria-hidden="true">
			</select>
	</div>
	<div class="form-group">
		<label for="district_from">Quận/Huyện</label>
				 <select class="form-control select2" name="district_from" id="district_from" tabindex="-1" aria-hidden="true">
				 </select>                       
	</div>
	<div class="form-group" id="form" >
		<label for="weight">Trọng Lượng: đơn vị gram</label>
		<input class="form-control" name="weight" id="weight" placeholder="Gram" pattern="[0-9]" required></input>
	</div>
	<div class="form-group">		
		<button class="form-control btn btn-success" id="action" >Tính Cước</button>
		<p></p>
		<label for="resole">Cước Phí:</label>
		<h1 class="form-control" name="resole" id="resole"></h1>
	</div>
	</form>
          
      </div>
    </section><!-- End Contact Section -->

  </main><!-- End #main -->

  

  <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/jquery/jquery.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>
  <script src="assets/vendor/venobox/venobox.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

<!-- datatable -->
	<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>
	<script type="text/javascript" src="MyDataTables/Bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.4.2/tabletop.min.js"></script>
	
	
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>	
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>	
<script type="text/javascript" src="MyDataTables/DataTables/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="MyDataTables/DataTables/js/dataTables.bootstrap4.min.js"></script>
<script type="text/javascript" src="MyDataTables/Buttons/js/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="MyDataTables/Buttons/js/buttons.bootstrap4.min.js"></script>
<script type="text/javascript" src="MyDataTables/Select/js/dataTables.select.min.js"></script>
<script type="text/javascript" src="https://editor.datatables.net/extensions/Editor/js/dataTables.editor.min.js"></script>
<script type="text/javascript" src="https://editor.datatables.net/extensions/Editor/js/editor.bootstrap4.min.js"></script>


<script>
var dataOptDistrsist = "";
function init3() {
		Tabletop.init( { key: '1NobeJ-yv0xJNTjlqkZDokcebv6_OqxKobpJ6Q1psqek',
			callback: getDatasheet,
			simpleSheet: true } );
}

function showInfo3(datasheet){
		var jsonIssues = new Array(); // new Array
		var jsonIssues1chieu = new Array(); // new Array
		var htmlop = "";
		var htmlopdis  = "";
		function gethtml(province,value,text){
			return "<option data-province='"+province+"' value='"+value+"'>"+text+"</option>";		
		}
		function getdistrict(value,text){
			return "<option value='"+value+"'>"+text+"</option>";	
		}

		for ( var j = 0; j < datasheet.length ; j++ ) {
					// lay gia tri cua tung doi tuong hang ngang
					for ( prop in datasheet[j] ) {
					jsonIssues1chieu.push(datasheet[j][prop]);			
					}
					htmlopdis = htmlopdis + getdistrict(datasheet[j]["STT"],datasheet[j]["Tỉnh / TP"]) + "</br>"
					// xu ly bang sheet tinh thanh the option
					for( var i = 3; i<jsonIssues1chieu.length; i++){
						let kvprovince="";
						switch(i) {
						  case 3:
							kvprovince = "kv1";
							break;
						  case 4:
							kvprovince = "kv2";
							break;
						  default:
							kvprovince = "kv3";
						}
						let kv = jsonIssues1chieu[i];
						let vitrisub =0;
						do{		
							vitrisub = kv.search(/\n/);
							
							if(vitrisub>0){
								htmlop= htmlop + gethtml(jsonIssues1chieu[1],kvprovince,kv.substring(0,vitrisub)) +"</br>";
							}				
							// kiem tra dictrict cuoi cung
							if(kv.length >0 && vitrisub < 0 ){
								htmlop= htmlop + gethtml(jsonIssues1chieu[1],kvprovince,kv.substring(0,kv.length));
							}
							kv = kv.substring(vitrisub+1,kv.length);
						}while(vitrisub > 0)
							
					}
					jsonIssues.push(jsonIssues1chieu);				
					jsonIssues1chieu = [];
		}
					
					document.getElementById("province_from").innerHTML = htmlopdis;
					document.getElementById("district_from").innerHTML = htmlop;
					dataOptDistrsist = $('#district_from').find('option');
};

function run(getOptdistrict){
			var selectedProvince = $('#province_from').find('option:selected').val();
			var arrOpt = [];
			var showOptdistrict = "";
			// push opt vao mang
				getOptdistrict.each(function(){
					if($(this).data('province') == selectedProvince){
						arrOpt.push($(this).get(0).outerHTML);						
					}
				})
			arrOpt.forEach(function(item,value){
				showOptdistrict += item;
			})

			document.getElementById("district_from").innerHTML = showOptdistrict;
				

}
function tinhcuoc(){
	var valProvince = $("#province_from").find('option:selected').val();
	var valDistrict = $("#district_from").find('option:selected').val();
	var valWeight = $("#weight").val();
	var mientinh = valProvince.substring(0,1);
	
	//<------ tinh cuoc --->	
	if(valProvince!=""&&valDistrict!=""&&/^\d+$/.test(valWeight)){
				function ktsokg(kg,tienthem){
					if(kg==0){return 0;}
					else if(kg<=0.5){ return tienthem;}
					else{return tienthem*2}
				}
				function tinhcuoctrongtinh(tienc,tiencongthem){
					if(valWeight<=3000){return tienc}									
					else{
						let kgnhap = valWeight/1000;
						let kgconlai = kgnhap -0.5;
						var kgtienthem = kgconlai - Math.floor(kgconlai);
						return tienc + tiencongthem*(Math.floor(kgconlai)/0.5) + ktsokg(kgtienthem,tiencongthem);
					}	
				}
				function tinhcuocngoaitinh(tienc1,tienc2,tiencongthem){
					if(valWeight<=200){return tienc1}
					else if(valWeight<=500){return tienc2}
					else{
						let kgnhap = valWeight/1000;
						let kgconlai = kgnhap -0.5;
						let kgtienthem = kgconlai - Math.floor(kgconlai);
						return tienc2 + tiencongthem*(Math.floor(kgconlai)/0.5) + ktsokg(kgtienthem,tiencongthem);
					}	
				}
				if(mientinh =='N'){
						if(valProvince=="NTNH"){
								if(valDistrict=="kv3"){
									return tinhcuoctrongtinh(16500,2500);	
								}else{	
									return tinhcuoctrongtinh(30000,2500);																									
								}
						}else{
							if(valDistrict =="kv3"){
								return tinhcuocngoaitinh(35000,35000,2500);							
							}else{
								return tinhcuocngoaitinh(25000,30000,2500);																								
							}
						}
				}else{	
						if(valDistrict =="kv3"){
							return tinhcuocngoaitinh(37000,40000,5000);														
						}else{
							return tinhcuocngoaitinh(27000,32000,5000);						
						}
				}		
	}else{
		return "Vui lòng điền đúng trọng lượng" 
	}
}
function getDatasheet(datasheet) {

	showInfo3(datasheet);
	run(dataOptDistrsist);	
}
init3();
$(document).ready(function($) {
		$(".select2").select2();
		$('#province_from').change(
			function(){
				
				run(dataOptDistrsist);
			}
		);
		$('#action').click(function(){
			var cuoc = tinhcuoc();
			document.getElementById("resole").innerHTML = cuoc;
		})
})		
// call the function 
</script>
<script>
	function init() {
					Tabletop.init( { key: '1dGPzaHBV32CheFR3omLwRRHeWlaylFHfYWKD7mMg5HU',
						callback: showInfo,
						simpleSheet: true } );
			}
	function showInfo(data) {	

			var jsonIssues = new Array(); // new Array
			var jsonIssues1chieu = new Array(); // new Array				 -->
			for ( i = 0; i < data.length; i++ ) {
						for ( prop in data[i] ) {
						jsonIssues1chieu.push(data[i][prop]);}
						jsonIssues.push(jsonIssues1chieu);	
						jsonIssues1chieu = [];
					};
			$(document).ready(function() {
		var editor;	
		var table	=	$('#example').DataTable( {
					<!-- dom: "Bfrtip", -->
					data: jsonIssues,
					columns: [
						{ title: "Dấu thời gian" },
						{ title: "Tên facebook" },
						{ title: "Họ và tên" },
						{ title: "Sô điện thoại." },
						{ title: "Địa chỉ nhà" },
						{ title: "Dịch vụ giao hàng" },
						{ title: "Tiền giao hàng" },
						{ title: "Nhu cầu khách hàng" },
						{ title: "Ghi chú" },
					],
					select: true,
					<!-- buttons: [ -->
						<!-- { extend: "create", editor: editor }, -->
						<!-- { extend: "edit",   editor: editor }, -->
						<!-- { extend: "remove", editor: editor } -->
					<!-- ] -->
				} );
				new $.fn.dataTable.Buttons( table, [
					{ extend: "create", editor: editor },
					{ extend: "edit",   editor: editor },
					{ extend: "remove", editor: editor }
				] );
 
    table.buttons().container()
        .appendTo( $('.col-md-6:eq(0)', table.table().container() ) );
			});
	}
	init();
// call the function 
</script>
<script>

	var public_spreadsheet_url1 = '1K4KydbZ8wGs1CVbaMRlhHSpha7CCNB5yi_Nt2rbPKPY';


function init1() {
		Tabletop.init( { key: public_spreadsheet_url1,
			callback: showInfo1,
			simpleSheet: true } );
}

function showInfo1(data) {

	var jsonIssues = new Array(); // new Array
	var jsonIssues1chieu = new Array(); // new Array				 -->
	for ( i = 0; i < data.length; i++ ) {
			for ( prop in data[i] ) {
			jsonIssues1chieu.push(data[i][prop]);	
			}
			jsonIssues.push(jsonIssues1chieu);	
			jsonIssues1chieu = [];
	}
	$(document).ready(function() {
    $('#example1').DataTable( {
        data: jsonIssues,
        columns: [
            { title: "Dấu thời gian" },
            { title: "Tên facebook" },
            { title: "Họ và tên" },
            { title: "Sô điện thoại." },
            { title: "Địa chỉ nhà" },
            { title: "Nhu cầu khách hàng" },
            { title: "Ghi chú" },
        ]
    } );
} );
}
init1();
// call the function 
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>

</html>