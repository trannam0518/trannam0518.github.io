<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.4.2/tabletop.min.js"></script>
  </head>
  <body>
  <div class="pos-f-t">
	  <div class="collapse" id="navbarToggleExternalContent">
		<div class="bg-dark p-4">
		  <a class="list-group-item list-group-item-action btn-primary" href="danhsachdahoantat.html">Danh sach da hoan tat</a>
			<a class="list-group-item list-group-item-action btn-primary" href="danhsachchuahoantat.html">danh sach chua hoan tat</a>
		</div>
	  </div>
	  <nav class="navbar navbar-dark bg-dark">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
		  <span class="navbar-toggler-icon"></span>
		</button>
	  </nav>
	</div>
	<p></P>
	<table id="example" class="display table-bordered" width="100%"></table>
    <script>
  /**
   * Sample JavaScript code for sheets.spreadsheets.get
   * See instructions for running APIs Explorer code samples locally:
   * https://developers.google.com/explorer-help/guides/code_samples#javascript
   */
	var public_spreadsheet_url = '1K4KydbZ8wGs1CVbaMRlhHSpha7CCNB5yi_Nt2rbPKPY';
  <!-- function authenticate() { -->
    <!-- return gapi.auth2.getAuthInstance() -->
        <!-- .signIn({scope: "https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/spreadsheets.readonly"}) -->
        <!-- .then(function() { console.log("Sign-in successful"); }, -->
              <!-- function(err) { console.error("Error signing in", err); }); -->
  <!-- } -->
  <!-- function loadClient() { -->
    <!-- gapi.client.setApiKey("AIzaSyAmmFrS6YXxbkgloIBRu4iuSMh_B8c0cpI"); -->
    <!-- return gapi.client.load("https://content.googleapis.com/discovery/v1/apis/sheets/v4/rest") -->
        <!-- .then(function() { console.log("GAPI client loaded for API"); }, -->
              <!-- function(err) { console.error("Error loading GAPI client for API", err); }); -->
  <!-- } -->
  <!-- // Make sure the client is loaded and sign-in is complete before calling this method. -->
  <!-- function execute() { -->
    <!-- return gapi.client.sheets.spreadsheets.get({ -->
      <!-- "spreadsheetId": public_spreadsheet_url, -->
      <!-- "includeGridData": true -->
    <!-- }) -->
        <!-- .then(function(response) { -->
                <!-- // Handle the results here (response.result has the parsed body). -->
                <!-- console.log("Response", response); -->
              <!-- }, -->
              <!-- function(err) { console.error("Execute error", err); }); -->
  <!-- } -->
  <!-- gapi.load("client:auth2", function() { -->
    <!-- gapi.auth2.init({client_id: "110235880853-p6cjhd7vnlibr40lvt0fj1minjk0repo.apps.googleusercontent.com"}); -->
  <!-- }); -->

// https://docs.google.com/spreadsheet/pub?hl=en_US&hl=en_US&key=0AmYzu_s7QHsmdDNZUzRlYldnWTZCLXdrMXlYQzVxSFE&output=html 

// Note - in a newer Google Sheets URL, the "key" is between the slashes 
// 1ReMXiz9K7p70yglhq1BAFsaIfUalSzq30wiXtT61GFw is the "key" from:  https://docs.google.com/spreadsheets/d/1ReMXiz9K7p70yglhq1BAFsaIfUalSzq30wiXtT61GFw/pubhtml


function init() {
		Tabletop.init( { key: public_spreadsheet_url,
			callback: showInfo,
			simpleSheet: true } );
}

function showInfo(data) {

	var jsonIssues = new Array(); // new Array
	var jsonIssues1chieu = new Array(); // new Array				 -->
	for ( i = 0; i < data.length; i++ ) {
			for ( prop in data[i] ) {
			jsonIssues1chieu.push(data[i][prop]);	
			}
			jsonIssues.push(jsonIssues1chieu);	
			jsonIssues1chieu = [];
	}
	$(document).ready(function() {
    $('#example').DataTable( {
        data: jsonIssues,
        columns: [
            { title: "Dấu thời gian" },
            { title: "Tên facebook" },
            { title: "Họ và tên" },
            { title: "Sô điện thoại." },
            { title: "Địa chỉ nhà" },
            { title: "Nhu cầu khách hàng" },
            { title: "Ghi chú" },
        ]
    } );
} );
}
init();
// call the function 
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    
  </body>
</html>
